$sides: (
  t:      top,
  r:      right,
  b:      bottom,
  l:      left,
  empty:  empty
);

/* stylelint-disable */
@function _process-counter($i, $step-threshold-map) {
  $prev-threshold: 0;

  @each $step, $threshold in $step-threshold-map {
    @if ($i >= $prev-threshold and $i < $threshold) {
      $i: $i + $step;
    }

    $prev-threshold: $threshold;
  }

  @return $i;
}

// Creates classes with .z-index-1 format
// We increment step by 1 until threshold is reached that we increment by $step
// Loop ends when $limit is reached
@mixin z-index($class-name, $config) {
  $i: 0;
  $limit: map_get($config, limit);
  $step-threshold-map: map_get($config, step-threshold-map);

  @while ($i < $limit) {
    .#{$class-name}-#{$i} {
      z-index: $i;
    }

    $i: _process-counter($i, $step-threshold-map);
  }
}
/* stylelint-enable */

@mixin borders($class-name, $config) {
  $thickness: if(map_get($config, thickness) != null, map_get($config, border-thickness), 1px);
  $color: map_get($config, color);
  $radius: map_get($config, radius);

  .#{$class-name}-none {
    border: 0;
  }

  .#{$class-name}-rounded {
    border-radius: 50%;
  }

  .#{$class-name}-radius {
    border-radius: $radius;
  }

  @each $key, $value in $sides {
    /* stylelint-disable */
    @if ($key != empty) {
      .#{$class-name}-#{$key} {
        border-#{$value}: $thickness solid $color;
      }
    } @else {
      .#{$class-name} {
        border: $thickness solid $color;
      }
    }
    /* stylelint-enable */
  }
}

@mixin indents($config) {
  $mixin-class-name: map_get($config, class-name);
  $mixin-property-name: map_get($config, property-name);
  $limit: map_get($config, limit);
  $step-threshold-map: map_get($config, step-threshold-map);

  @each $key, $value in $sides {
    $i: 1;

    @while ($i < $limit) {
      $class-name: '';
      $prop-name: '';
      $prop-value: '';

      /* stylelint-disable */
      @if ($key != empty) {
        $class-name: #{$mixin-class-name}-#{$key}-#{$i};
        $prop-name: #{$mixin-property-name}-#{$value};
        $prop-value: $i;
      } @else {
        $class-name: #{$mixin-class-name}-#{$i};
        $prop-name: $mixin-property-name;
        $prop-value: $i;
      }

      // positive
      .#{$class-name} {
        #{$prop-name}: #{$prop-value}px;
      }

      // negative
      // Don't construct negative values for padding
      @if ($prop-name != padding) {
        $class-name: #{$mixin-class-name}-#{$key}-n-#{$i};
        .#{$class-name} {
          #{$prop-name}: -#{$prop-value}px;
        }
      }

      @if ($key != empty) {
        .#{$mixin-class-name}-#{$key}-none {
          #{$mixin-property-name}-#{$value}: 0;
        }
      }

      $i: _process-counter($i, $step-threshold-map);
    }
  }

  .#{$mixin-class-name}-none {
    #{$mixin-property-name}: 0 !important;
  }
  /* stylelint-enable */
}

@mixin bootstrap($config) {
  $z-index-config: map_get($config, z-index);
  $borders-config: map_get($config, border);

  @include z-index($z-index-config);
  @include borders($borders-config);
  @include indents(p, padding);
  @include indents(m, margin);
}
